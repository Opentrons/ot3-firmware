{
  "version": 2,
  "cmakeMinimumRequired": {
    "major": 3,
    "minor": 20,
    "patch": 0
  },
  "configurePresets": [
    {
      "name": "configuration-ok",
      "hidden": true,
      "environment": {
        "PRESET_IN_USE": "1"
      }
    },
    {
      "name": "cross",
      "displayName": "STM32 G4 OT-3 cross-compilation",
      "description": "Build application firmware for OT-3 systems that use STM32, for flashing onto boards",
      "generator": "Unix Makefiles",
      "binaryDir": "${sourceDir}/build-cross",
      "cacheVariables": {
        "CMAKE_EXPORT_COMPILE_COMMANDS": true,
        "CMAKE_MODULE_PATH": "${sourceDir}/cmake",
        "CMAKE_FIND_APPBUNDLE": "NEVER",
        "CMAKE_TOOLCHAIN_FILE": "${sourceDir}/cmake/STM32CortexM4GCCCrossToolchain.cmake",
        "ARM_ARCH_TYPE": "cortex-m4"
      },
      "inherits": "configuration-ok"
    },
    {
      "name": "cross-pipettes",
      "displayName": "STM32 L5 OT-3 cross-compilation",
      "description": "Build application firmware for OT-3 systems that use STM32, for flashing onto boards",
      "generator": "Unix Makefiles",
      "binaryDir": "${sourceDir}/build-cross-pipettes",
      "cacheVariables": {
        "CMAKE_EXPORT_COMPILE_COMMANDS": true,
        "CMAKE_MODULE_PATH": "${sourceDir}/cmake",
        "CMAKE_FIND_APPBUNDLE": "NEVER",
        "CMAKE_TOOLCHAIN_FILE": "${sourceDir}/cmake/STM32CortexM33GCCCrossToolchain.cmake",
        "ARM_ARCH_TYPE": "cortex-m33"
      },
      "inherits": "configuration-ok"
    },
    {
      "name": "host",
      "displayName": "STM32 OT-3 host compilation for tests",
      "description": "Build libraries and test executables for OT-3 systems that use STM32",
      "generator": "Unix Makefiles",
      "binaryDir": "${sourceDir}/build-host",
      "cacheVariables": {
        "CMAKE_FIND_APPBUNDLE": "NEVER",
        "CMAKE_EXPORT_COMPILE_COMMANDS": true
      },
      "inherits": "configuration-ok"
    },
    {
      "name": "host-gcc10",
      "inherits": [
        "host",
        "configuration-ok"
      ],
      "displayName": "STM32 module host builds forcing g++",
      "cacheVariables": {
        "CMAKE_C_COMPILER": "gcc-10",
        "CMAKE_CXX_COMPILER": "g++-10"
      }
    },
    {
      "name": "host-gcc10-python",
      "inherits": [
        "host-gcc10",
        "configuration-ok"
      ],
      "displayName": "STM32 firmware host builds with gcc10 and python"
    }
  ],
  "buildPresets": [
    {
      "name": "pipettes",
      "displayName": "pipettes binary",
      "description": "Build the pipettes cross binary",
      "configurePreset": "cross-pipettes",
      "jobs": 4,
      "targets": [
        "pipettes-single",
        "pipettes-multi",
        "pipettes-96",
        "pipettes-384"
      ]
    },
    {
      "name": "pipettes-single",
      "inherits": "pipettes",
      "displayName": "pipettes single binary",
      "description": "Build the single channel pipettes cross binary",
      "targets": [
        "pipettes-single"
      ]
    },
    {
      "name": "pipettes-multi",
      "inherits": "pipettes",
      "displayName": "pipettes multi binary",
      "description": "Build the multi channel pipettes cross binary",
      "targets": [
        "pipettes-multi"
      ]
    },
    {
      "name": "pipettes-96",
      "inherits": "pipettes",
      "displayName": "pipettes 96 channel binary",
      "description": "Build the 96 channel pipettes cross binary",
      "targets": [
        "pipettes-96"
      ]
    },
    {
      "name": "pipettes-384",
      "inherits": "pipettes",
      "displayName": "pipettes 384 channel binary",
      "description": "Build the 384 channel pipettes cross binary",
      "targets": [
        "pipettes-384"
      ]
    },
    {
      "name": "gripper",
      "displayName": "gripper binary",
      "description": "Build the gripper cross binary",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "gripper"
      ]
    },
    {
      "name": "gantry",
      "displayName": "gantry binaries",
      "description": "build the gantry binary targets",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "gantry-x-proto",
        "gantry-y",
        "gantry-x-rev1",
        "gantry-y-rev1"
      ]
    },
    {
      "name": "gantry-x",
      "displayName": "x axis binary",
      "description": "build the x axis binary target",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "gantry-x-proto",
        "gantry-x-rev1"
      ]
    },
    {
      "name": "gantry-y",
      "displayName": "y axis binary",
      "description": "build the y axis binary target",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "gantry-y-proto",
        "gantry-y-rev1"
      ]
    },
    {
      "name": "head",
      "displayName": "head binary",
      "description": "build the head binary targets",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "head"
      ]
    },
    {
      "name": "tests",
      "displayName": "tests",
      "description": "build and run all tests",
      "configurePreset": "host",
      "jobs": 4,
      "targets": [
        "build-and-test"
      ]
    },
    {
      "name": "bootloader",
      "displayName": "bootloader binary",
      "description": "build the bootloader binary targets",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "bootloader-head",
        "bootloader-gantry-x",
        "bootloader-gantry-y",
        "bootloader-gripper"
      ]
    },
    {
      "name": "bootloader-pipettes",
      "displayName": "pipettes bootloader binary",
      "description": "build the pipettes bootloader binary targets",
      "configurePreset": "cross-pipettes",
      "jobs": 4,
      "targets": [
        "bootloader-pipettes"
      ]
    },
    {
      "name": "simulators",
      "displayName": "simulators",
      "description": "build the simulators",
      "configurePreset": "host",
      "jobs": 4,
      "targets": [
        "bootloader-simulator",
        "head-simulator",
        "gantry-x-simulator",
        "gantry-y-simulator",
        "pipettes-single-simulator",
        "pipettes-multi-simulator",
        "pipettes-96-simulator",
        "pipettes-384-simulator",
        "gripper-simulator"
      ]
    },
    {
      "name": "simulators-gcc10",
      "displayName": "simulators gcc10",
      "description": "build the simulators using gcc10 (osx)",
      "configurePreset": "host-gcc10",
      "jobs": 4,
      "targets": [
        "bootloader-simulator",
        "head-simulator",
        "gantry-x-simulator",
        "gantry-y-simulator",
        "pipettes-single-simulator",
        "pipettes-multi-simulator",
        "pipettes-96-simulator",
        "pipettes-384-simulator",
        "gripper-simulator"
      ]
    }
  ]
}
