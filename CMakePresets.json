{
  "version": 2,
  "cmakeMinimumRequired": {
    "major": 3,
    "minor": 20,
    "patch": 0
  },
  "configurePresets": [
    {
      "name": "configuration-ok",
      "hidden": true,
      "environment": {
        "PRESET_IN_USE": "1"
      }
    },
    {
      "name": "cross",
      "displayName": "STM32 G4 OT-3 cross-compilation",
      "description": "Build application firmware for OT-3 systems that use STM32, for flashing onto boards",
      "generator": "Unix Makefiles",
      "binaryDir": "${sourceDir}/build-cross",
      "cacheVariables": {
        "CMAKE_EXPORT_COMPILE_COMMANDS": true,
        "CMAKE_MODULE_PATH": "${sourceDir}/cmake;${sourceDir}/common/cmake",
        "CMAKE_FIND_APPBUNDLE": "NEVER",
        "CMAKE_TOOLCHAIN_FILE": "${sourceDir}/cmake/STM32CortexM4GCCCrossToolchain.cmake",
        "ARM_ARCH_TYPE": "cortex-m4"
      },
      "inherits": "configuration-ok"
    },
    {
      "name": "cross-pipettes",
      "displayName": "STM32 L5 OT-3 cross-compilation",
      "description": "Build application firmware for OT-3 systems that use STM32, for flashing onto boards",
      "generator": "Unix Makefiles",
      "binaryDir": "${sourceDir}/build-cross-pipettes",
      "cacheVariables": {
        "CMAKE_EXPORT_COMPILE_COMMANDS": true,
        "CMAKE_MODULE_PATH": "${sourceDir}/cmake;${sourceDir}/common/cmake",
        "CMAKE_FIND_APPBUNDLE": "NEVER",
        "CMAKE_TOOLCHAIN_FILE": "${sourceDir}/cmake/STM32CortexM33GCCCrossToolchain.cmake",
        "ARM_ARCH_TYPE": "cortex-m33"
      },
      "inherits": "configuration-ok"
    },
    {
      "name": "host",
      "displayName": "STM32 OT-3 host compilation for tests",
      "description": "Build libraries and test executables for OT-3 systems that use STM32",
      "generator": "Unix Makefiles",
      "binaryDir": "${sourceDir}/build-host",
      "cacheVariables": {
        "CMAKE_FIND_APPBUNDLE": "NEVER",
        "CMAKE_EXPORT_COMPILE_COMMANDS": true
      },
      "inherits": "configuration-ok"
    },
    {
      "name": "host-gcc10",
      "inherits": [
        "host",
        "configuration-ok"
      ],
      "displayName": "STM32 module host builds forcing g++",
      "cacheVariables": {
        "CMAKE_C_COMPILER": "gcc-10",
        "CMAKE_CXX_COMPILER": "g++-10"
      }
    },
    {
      "name": "host-gcc10-python",
      "inherits": [
        "host-gcc10",
        "configuration-ok"
      ],
      "displayName": "STM32 firmware host builds with gcc10 and python"
    }
  ],
  "buildPresets": [
    {
      "name": "all-application-firmware",
      "displayName": "all application hex binary",
      "description": "Build all the hex binaries that will go on the OT3 filesystem.",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "head-rev1-hex",
        "gantry-x-rev1-hex",
        "gantry-y-rev1-hex",
        "gripper-rev1-hex",
        "pipettes-single-rev1-hex",
        "pipettes-multi-rev1-hex",
        "pipettes-96-rev1-hex",
        "pipettes-384-rev1-hex"
      ]
    },
    {
      "name": "pipettes-a1",
      "displayName": "pipettes binary",
      "description": "Build the pipettes cross binary",
      "configurePreset": "cross-pipettes",
      "jobs": 4,
      "targets": [
        "pipettes-images"
      ]
    },
    {
      "name": "pipettes-proto",
      "inherits": ["pipettes-a1"]
    },
    {
      "name": "pipettes",
      "displayName": "pipettes binaries",
      "description": "Build the pipettes cross binary",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "pipettes-images"
      ]
    },
    {
      "name": "pipettes-rev1",
      "inherits": ["pipettes"]
    },
    {
      "name": "pipettes-single",
      "inherits": ["pipettes"],
      "displayName": "pipettes single binary",
      "description": "Build the single channel pipettes cross binary",
      "targets": [
        "pipettes-single-images"
      ]
    },
    {
      "name": "pipettes-multi",
      "inherits": ["pipettes"],
      "displayName": "pipettes multi binary",
      "description": "Build the multi channel pipettes cross binary",
      "targets": [
        "pipettes-multi-images"
      ]
    },
    {
      "name": "pipettes-96",
      "inherits": ["pipettes"],
      "displayName": "pipettes 96 channel binary",
      "description": "Build the 96 channel pipettes cross binary",
      "targets": [
        "pipettes-96-images"
      ]
    },
    {
      "name": "gripper",
      "displayName": "gripper binary",
      "description": "Build the gripper cross binary",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "gripper"
      ]
    },
    {
      "name": "gantry",
      "displayName": "gantry binaries",
      "description": "build the gantry binary targets",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "gantry-images"
      ]
    },
    {
      "name": "gantry-x",
      "displayName": "x axis binary",
      "description": "build the x axis binary target",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "gantry-x-images"
      ]
    },
    {
      "name": "gantry-y",
      "displayName": "y axis binary",
      "description": "build the y axis binary target",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "gantry-y-images"
      ]
    },
    {
      "name": "head",
      "displayName": "head binary",
      "description": "build the head binary targets",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "head-images"
      ]
    },
    {
      "name": "rear-panel",
      "displayName": "rear-panel binary",
      "description": "build the rear binary targets",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "rear-panel-images"
      ]
    },
    {
      "name": "tests",
      "displayName": "tests",
      "description": "build and run all tests",
      "configurePreset": "host",
      "jobs": 4,
      "targets": [
        "build-and-test"
      ]
    },
    {
      "name": "bootloader",
      "displayName": "bootloader binary",
      "description": "build the bootloader binary targets",
      "configurePreset": "cross",
      "jobs": 4,
      "targets": [
        "bootloader-head",
        "bootloader-gantry-x",
        "bootloader-gantry-y",
        "bootloader-gripper",
        "bootloader-pipettes-rev1"
      ]
    },
    {
      "name": "bootloader-pipettes",
      "displayName": "pipettes bootloader binary",
      "description": "build the pipettes bootloader binary targets",
      "configurePreset": "cross-pipettes",
      "jobs": 4,
      "targets": [
        "bootloader-pipettes-proto"
      ]
    },
    {
      "name": "simulators",
      "displayName": "simulators",
      "description": "build the simulators",
      "configurePreset": "host",
      "jobs": 4,
      "targets": [
        "state-manager-setup",
        "bootloader-simulator",
        "head-simulator",
        "gantry-x-simulator",
        "gantry-y-simulator",
        "pipettes-single-simulator",
        "pipettes-multi-simulator",
        "pipettes-96-simulator",
        "pipettes-384-simulator",
        "gripper-simulator"
      ]
    },
    {
      "name": "simulators-gcc10",
      "displayName": "simulators gcc10",
      "description": "build the simulators using gcc10 (osx)",
      "configurePreset": "host-gcc10",
      "jobs": 4,
      "targets": [
        "state-manager-setup",
        "bootloader-simulator",
        "head-simulator",
        "gantry-x-simulator",
        "gantry-y-simulator",
        "pipettes-single-simulator",
        "pipettes-multi-simulator",
        "pipettes-96-simulator",
        "pipettes-384-simulator",
        "gripper-simulator"
      ]
    }
  ]
}
